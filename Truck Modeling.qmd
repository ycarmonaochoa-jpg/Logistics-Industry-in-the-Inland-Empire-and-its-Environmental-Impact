---
title: "Truck Modeling"
format: html
editor: visual
---

```{r}
library(deSolve)
library(tidyverse)
```

Create DE

```{r}
truck_model <- function(square, param_a, param_b, param_c, param_d, param_w){
#Parameters
parameters <- c(
  a = param_a,
  b = param_b,
  
  c1 = param_c[1],
  c2 = param_c[2],
  c3 = param_c[3],
  c4 = param_c[4],
  
  d1 = param_d[1],
  d2 = param_d[2],
  d3 = param_d[3],
  d4 = param_d[4],
  
  w1 = param_w[1],
  w2 = param_w[2]
  )

#Initial Conditions
state <- c(
  R = 1,
  W = 1
)


#Growth function
truck_growth <- function(t, state, parameters) {
 with(as.list(c(state, parameters)),{
 # rate of change
  dR <- b*W - a*R - d1*R - d2*R - d3*R - d4*R
  dW <- w1*(1 - w2*W)

 # return the rate of change
 list(c(dR, dW))
 })
}

#time step and how long to run ODE
time_step <- 0.01
max_time <- 100
times <- seq(0, max_time, by = time_step)

#Run
truck_growth_results <- ode(y = state, times = times, func = truck_growth, parms = parameters) |>
  as_tibble() |>
  mutate(square = square)
truck_growth_results
}

truck_model("Test Square", 
            1, #a parameter
            1, #b parameter
            c(1, 1, 1, 1), #c parameter vector
            c(0, 0, 0, 0.5), #d parameter vector
            c(0.5, 0.5) #w parameter vector
)
```

```{r}
#R vs time graph
ggplot(truck_growth_results) +
  geom_line(aes(x = time, y = R)) +
  theme_classic()

#W vs time graph
ggplot(truck_growth_results) +
  geom_line(aes(x = time, y = W)) +
  theme_classic()
```

```{r}
O <- list()
for(i in 1:3){
  A <- i
  B <- i +1
  O[[i]] <- A
  O[[i + 3]] <- B
  end
}
as.vector(O)
```
